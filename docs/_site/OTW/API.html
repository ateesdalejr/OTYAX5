<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <title>OTYA WINDOW SYSTEM(OTW)</title>
</head>

<body>
<h1 id="otya-window-systemotw">OTYA WINDOW SYSTEM(OTW)</h1>
<p>開発中
(OTW5.0)
ボタンもテキストボックスもみんなウィンドウ</p>

<h2 id="control">Control</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GetWindowControl()</td>
      <td>Windowのコントロールを取得</td>
    </tr>
    <tr>
      <td>NewControl NAME$ OUT CTL,ERR</td>
      <td>新しいコントロールを作る</td>
    </tr>
    <tr>
      <td>ExtendControl NAME$,PARENT OUT CTL,ERR</td>
      <td>既存のコントロール(Windowなど)を継承</td>
    </tr>
    <tr>
      <td>CheckControl(CTL)</td>
      <td>コントロールが正常かを確認</td>
    </tr>
    <tr>
      <td>DeleteControl(CTL)</td>
      <td>コントロールを削除</td>
    </tr>
    <tr>
      <td>FindControl(NAME$)</td>
      <td>文字列を使ってコントロールを取得</td>
    </tr>
    <tr>
      <td>IsControlExtend(CTL,PARENT)</td>
      <td>CTLコントロールとPARENTコントロールが継承関係にあるかどうか</td>
    </tr>
  </tbody>
</table>

<h3 id="handler">Handler</h3>
<p>Handlerの書式
COMMONは付ける</p>

<p><code class="highlighter-rouge">COMMON DEF XXX WND,CTL,TYPE,A1,A2</code></p>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
      <th>引数1</th>
      <th>引数2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SetControlPainter(CTL,HANDLER$)</td>
      <td>コントロールの描画イベントを処理する関数の登録</td>
      <td>描画範囲XY</td>
      <td>描画範囲WH(XY=0&amp;&amp;WH=0のとき全体)</td>
    </tr>
    <tr>
      <td>SetControlLMouseUpHandler(CTL,HANDLER$)</td>
      <td>左クリック(ボタンから離されたとき)のイベントを処理する関数の登録</td>
      <td>X</td>
      <td>Y</td>
    </tr>
    <tr>
      <td>SetControlLMouseDownHandler(CTL,HANDLER$)</td>
      <td>左クリック(ボタンが押されたとき)のイベントを処理する関数の登録</td>
      <td>X</td>
      <td>Y</td>
    </tr>
    <tr>
      <td>SetControlMouseMoveHandler(CTL,HANDLER$)</td>
      <td>マウスが移動したときのイベントを処理する関数の登録</td>
      <td>XY</td>
      <td>マウスの状態</td>
    </tr>
    <tr>
      <td>SetControlNotificationHandler(CTL,HANDLER$)</td>
      <td>通知(ボタンがクリックされた、Enterが押された)など</td>
      <td><del>そのウィンドウのVar0</del>そのウィンドウのWND</td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlNotifHandler(CTL,HANDLER$)</td>
      <td>=SetControlNotificationHandler</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlKeyHandler(CTL,HANDLER$)</td>
      <td>キーが押されたとき</td>
      <td>BUTTON()から特殊キーを覗いた値</td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlChFocusHandler(CTL,HANDLER$)</td>
      <td>フォーカスが変わった時</td>
      <td>フォーカスが移ったらTRUE</td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlButtonHandler(CTL,HANDLER$)</td>
      <td>ボタンが押されたとき</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlCreateHandler(CTL,HANDLER$)</td>
      <td>ウィンドウが作られたとき</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlStrNotifHandler(CTL,HANDLER$)</td>
      <td>文字列の通知(FileDialog等)</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlDeleteHandler(CTL,HANDLER$)</td>
      <td>ウィンドウが削除されたとき</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlLDoubleClickHandler(CTL,HANDLER$)</td>
      <td>左ダブルクリックをされたとき</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlMouseLeaveHandler(CTL,HANDLER$)</td>
      <td>マウスが離れた時</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlResizeHandler(CTL,HANDLER$)</td>
      <td>ウィンドウがリサイズされたとき</td>
      <td> </td>
      <td>WH</td>
    </tr>
    <tr>
      <td>SetControlFrameHandler(CTL,HANDLER$)</td>
      <td>ウィンドウフレーム周りのなんか</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlFramePainter(CTL,HANDLER$)</td>
      <td>ウィンドウフレームの描画</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>SetControlChildWindowHandler(CTL,HANDLER$)</td>
      <td>子ウィンドウから送られてくるイベントを受信</td>
      <td>type</td>
      <td>arg</td>
    </tr>
  </tbody>
</table>

<h3 id="controlchildwindowhandler">ControlChildWindowHandler</h3>
<p>子ウィンドウに何か起こった時に呼ばれる</p>

<h4 id="typewindowmaximizeevent">type:WindowMaximizeEvent()</h4>
<p>ウィンドウが最大化されようとしたときに送られる</p>

<p>argに対象ウィンドウ<br />
rootウィンドウ</p>

<h4 id="typewindowminimizevent">type:WindowMinimizevent()</h4>
<p>ウィンドウが最小化されようとしたときに送られる<br />
argに対象ウィンドウ</p>

<h4 id="typewindowactiveevent">type:WindowActiveEvent()</h4>
<p>ウィンドウがアクティブになったときに贈られる
argに対象ウィンドウ</p>

<h3 id="section">マウスの状態</h3>
<div class="highlighter-rouge"><pre class="highlight"><code>   10
 0b00
 bit 0CTL_LBTNFLG
 bit 1CTL_RBTNFLG
</code></pre>
</div>
<p>1なら左クリック,2なら右クリック,3なら両方
<code class="highlighter-rouge">bas
 IF BTN AND GetControlStateLBtn()THEN ~左クリック
 IF BTN AND GetControlStateRBtn()THEN ~右クリック
</code></p>

<h2 id="window">Window</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GetRootWindow()</td>
      <td>ルートウィンドウを取得</td>
    </tr>
    <tr>
      <td>CheckWindow(WND)</td>
      <td>ウィンドウが正常化を確認</td>
    </tr>
    <tr>
      <td>WindowBackFlag()</td>
      <td>NewWindowで指定するフラグ, ウィンドウを後ろに配置する</td>
    </tr>
    <tr>
      <td>WindowFrontFlag()</td>
      <td>NewWindowで指定するフラグ, ウィンドウを前に配置する</td>
    </tr>
    <tr>
      <td>WindowHideFlag()</td>
      <td>NewWindowで指定するフラグ, ウィンドウを非表示にする</td>
    </tr>
    <tr>
      <td>NewWindow CTL,NAME$,X,Y,WIDTH,HEIGHT,PARENT,FLG OUT WND,ERR</td>
      <td>コントロールと名前と座標とサイズと親ウィンドウとフラグを使ってウィンドウを作成</td>
    </tr>
    <tr>
      <td>NewTopLevelWindow CTL,NAME$,WIDTH,HEIGHT OUT WND,ERR</td>
      <td>コントロールと名前とサイズを使ってウィンドウを作成</td>
    </tr>
    <tr>
      <td>NewStyleWindowArg CTL,NAME$,X,Y,WIDTH,HEIGHT,PARENT,FLG,STYLE,A1,A2</td>
      <td>引数を使ってスタイル指定されたウィンドウ作成</td>
    </tr>
    <tr>
      <td>NewStyleWindow CTL,NAME$,X,Y,WIDTH,HEIGHT,PARENT,FLG,STYLE</td>
      <td>スタイル指定されたウィンドウ作成</td>
    </tr>
    <tr>
      <td>NewTopLevelStyleWindowArg CTL,NAME$,WIDTH,HEIGHT,FLG,STYLE,A1,A2</td>
      <td>引数を使ってスタイル指定されたトップレベルウィンドウ作成</td>
    </tr>
    <tr>
      <td>NewTopLevelStyleWindow CTL,NAME$,WIDTH,HEIGHT,FLG,STYLE</td>
      <td>スタイル指定されたトップレベルウィンドウ作成</td>
    </tr>
    <tr>
      <td>WindowMenuStyle()</td>
      <td>メニュー付きにさせるフラグ</td>
    </tr>
    <tr>
      <td>WindowResizableStyle()</td>
      <td>リサイズ可能にさせるフラグ</td>
    </tr>
    <tr>
      <td>WindowHideStyle()</td>
      <td>非表示にさせるフラグ</td>
    </tr>
    <tr>
      <td>FrontWindow(WND)</td>
      <td>ウィンドウを手前に持ってくる</td>
    </tr>
    <tr>
      <td>MoveWindow(WND,X,Y)</td>
      <td>ウィンドウを指定座標に持っていく</td>
    </tr>
    <tr>
      <td>ResizeWindow(WND,W,H)</td>
      <td>ウィンドウをリサイズ</td>
    </tr>
    <tr>
      <td>MoveResizeWindow(WND,W,H)</td>
      <td>ウィンドウを移動してリサイズ</td>
    </tr>
    <tr>
      <td>SendWindowEvent(WND,TYPE,A1,A2)</td>
      <td>ウィンドウへイベントを送信</td>
    </tr>
    <tr>
      <td>RepaintWindow(WND)</td>
      <td>ウィンドウへ再描画イベントを送信</td>
    </tr>
    <tr>
      <td>RepaintFrameWindow(WND)</td>
      <td>ウィンドウのフレーム部分への再描画イベントを送信</td>
    </tr>
    <tr>
      <td>CallBaseControlHandler(WND,CTL,TYPE,A1,A2)</td>
      <td>(イベントのハンドラーで)親ハンドラを呼び出し</td>
    </tr>
    <tr>
      <td>PeekWindowEvent(WND)-&gt;OUT CTL,TYPE,A1,A2</td>
      <td>ウィンドウのイベントキューの先頭を削除せずに帰す</td>
    </tr>
    <tr>
      <td>UpdateWindow(WND)</td>
      <td>ウィンドウのイベントを処理</td>
    </tr>
    <tr>
      <td>GetWindowName$(WND)</td>
      <td>ウィンドウの名前を取得</td>
    </tr>
    <tr>
      <td>GetWindowWidth(WND)</td>
      <td>ウィンドウの幅を取得</td>
    </tr>
    <tr>
      <td>GetWindowHeight(WND)</td>
      <td>ウィンドウの高さを取得</td>
    </tr>
    <tr>
      <td>GetWinVer$()</td>
      <td>バージョンを取得(“5.0”など)</td>
    </tr>
    <tr>
      <td>GetWindowX(WND)</td>
      <td>ウィンドウのX座標を取得</td>
    </tr>
    <tr>
      <td>GetWindowY(WND)</td>
      <td>ウィンドウのY座標を取得</td>
    </tr>
    <tr>
      <td>GetNextWindow(WND)</td>
      <td>次のウィンドウ(前面)を取得,失敗したら0が返る</td>
    </tr>
    <tr>
      <td>GetPrevWindow(WND)</td>
      <td>次のウィンドウ(後面)を取得,失敗したら0が返る</td>
    </tr>
    <tr>
      <td>GetParentWindow(WND)</td>
      <td>親ウィンドウを取得</td>
    </tr>
    <tr>
      <td>GetChildWindow(WND)</td>
      <td>子ウィンドウを取得(一番後ろ)</td>
    </tr>
    <tr>
      <td>GetControl(WND)</td>
      <td>ウィンドウのコントロールを取得</td>
    </tr>
    <tr>
      <td>IsFocusWindow(WND)</td>
      <td>ウィンドウがフォーカスされていればTRUE</td>
    </tr>
    <tr>
      <td>IsActiveWindow(WND)</td>
      <td>ウィンドウがアクティブであればTRUE</td>
    </tr>
    <tr>
      <td>ShowWindow(WND)</td>
      <td>非表示ウィンドウを表示させる</td>
    </tr>
    <tr>
      <td>HideWindow(WND)</td>
      <td>ウィンドウを非表示にする(bug?)</td>
    </tr>
    <tr>
      <td>SetWindowBackColor WND,RGB</td>
      <td>ウィンドウの背景色を設定</td>
    </tr>
    <tr>
      <td>SetWindowBackColor(WND)</td>
      <td>ウィンドウの背景色を取得</td>
    </tr>
    <tr>
      <td>GetBackColor()</td>
      <td>ウィンドウのデフォルト背景色を取得</td>
    </tr>
    <tr>
      <td>GetSelectionColor()</td>
      <td>選択時の背景色を取得</td>
    </tr>
    <tr>
      <td>GetSelectionTextColor()</td>
      <td>選択時のテキスト色を取得</td>
    </tr>
    <tr>
      <td>GetWindowMinSize WND OUT W,H</td>
      <td>ウィンドウの最小サイズを取得(リサイズ用)</td>
    </tr>
    <tr>
      <td>SetWindowMinSize WND,W,H</td>
      <td>ウィンドウの最小サイズを設定(リサイズ用)</td>
    </tr>
    <tr>
      <td>SetCapture(WND)</td>
      <td>WNDに対してマウスキャプチャを開始,MouseMoveイベントが全てWNDに対して送られるようになる。但しマウスをクリックすると解除.返り値は前にキャプチャされたウィンドウ</td>
    </tr>
    <tr>
      <td>GetCapture()</td>
      <td>現在マウスキャプチャされているウィンドウを取得</td>
    </tr>
    <tr>
      <td>ReleaseCapture(WND)</td>
      <td>WNDに対してのマウスキャプチャを終了,失敗すると0、成功すると1が返る</td>
    </tr>
    <tr>
      <td>SetWindowProperty WND,PNAME$,VAL OUT ERR</td>
      <td>実装依存のプロパティ設定、OTW5.0-28では”SHADOW”を指定すると影の有無を切り替えられる</td>
    </tr>
    <tr>
      <td>CalcWindowX(BASEWND,WND)</td>
      <td>BASEWNDに対するWNDの位置を取得</td>
    </tr>
    <tr>
      <td>CalcWindowY(BASEWND,WND)</td>
      <td>BASEWNDに対するWNDの位置を取得</td>
    </tr>
    <tr>
      <td>GetActiveWindow()</td>
      <td>現在のアクティブウィンドウを取得</td>
    </tr>
    <tr>
      <td>MaximizeWindow(WND)</td>
      <td>ウィンドウを最大化</td>
    </tr>
    <tr>
      <td>MinimizeWindow(WND)</td>
      <td>ウィンドウを最小化</td>
    </tr>
    <tr>
      <td>GetWindowStyle(WND)</td>
      <td>ウィンドウスタイルを取得</td>
    </tr>
    <tr>
      <td>GetWindowFrameSize WND OUT W1,H1,W2,H2,ERR</td>
      <td>ウィンドウフレームサイズを取得</td>
    </tr>
  </tbody>
</table>

<h3 id="graphic">Graphic</h3>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GBeginWindow(WND)</td>
      <td>描画開始を明示的に宣言する</td>
    </tr>
    <tr>
      <td>GEndWindow(WND)</td>
      <td>描画終了を明示的に宣言する</td>
    </tr>
    <tr>
      <td>SetWindowDrawPos WND,X,Y</td>
      <td>描画の始点を変更(デフォルトで(0,0)</td>
    </tr>
    <tr>
      <td>GPSETWindow WND,X,Y,COL</td>
      <td>ウィンドウに点を書く</td>
    </tr>
    <tr>
      <td>GFILLWindow WND,X,Y,X2,Y2,COL</td>
      <td> </td>
    </tr>
    <tr>
      <td>GBOXWindow WND,X,Y,X2,Y2,COL</td>
      <td> </td>
    </tr>
    <tr>
      <td>GLINEWindow WND,X,Y,X2,Y2,COL</td>
      <td> </td>
    </tr>
    <tr>
      <td>GetConsolePalette(PAL)</td>
      <td>コンソールの色を取得</td>
    </tr>
    <tr>
      <td>GPRINTWindowCC WND,X,Y,STR$,PAL</td>
      <td>コンソール色で文字を表示</td>
    </tr>
    <tr>
      <td>GPRINTWindow WND,X,Y,STR$,COL</td>
      <td> </td>
    </tr>
    <tr>
      <td>GPRINTBWindow WND,X,Y,STR$,COL,BC</td>
      <td>背景色を指定してGPRINT</td>
    </tr>
    <tr>
      <td>GPUTCHRWindow WND,X,Y,A,COL</td>
      <td> </td>
    </tr>
    <tr>
      <td>GPUTCHRSizeWindow WND,X,Y,A,SX,SY,COL</td>
      <td>サイズ(SX:SY)を指定してGPUTCHR</td>
    </tr>
    <tr>
      <td>GPUTCHRSize1Window WND,X,Y,A,SX,COL</td>
      <td>サイズ(S:S)を指定してGPUTCHR</td>
    </tr>
    <tr>
      <td>GPUTCHRBWindow WND,X,Y,A,COL,BC</td>
      <td>背景色を指定してGPUTCHR</td>
    </tr>
    <tr>
      <td>GLOADWindow WND,X,Y,W,H,IMG[],FLG,MODE</td>
      <td> </td>
    </tr>
    <tr>
      <td>GCOPYWindow WND…</td>
      <td>廃止予定</td>
    </tr>
    <tr>
      <td>GTRIWindow WND,X,Y,X2,Y2,X3,Y3,COL</td>
      <td> </td>
    </tr>
    <tr>
      <td>GCIRCLEWindow WND,X,Y,R,COL</td>
      <td> </td>
    </tr>
    <tr>
      <td>GCIRCLE2Window WND,X,Y,R,S,E,F,COL</td>
      <td> </td>
    </tr>
    <tr>
      <td>GLOADImageWindow WND,X,Y,IMG,F</td>
      <td>画像をウィンドウに描画</td>
    </tr>
  </tbody>
</table>

<h2 id="gui">標準GUI部品</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GetWindowControl()</td>
      <td>ウィンドウを表示するコントロール</td>
    </tr>
    <tr>
      <td>GetButtonControl()</td>
      <td>ボタンを表示するコントロール</td>
    </tr>
    <tr>
      <td>GetToggleButtonControl()</td>
      <td>トグルボタンを表示するコントロール</td>
    </tr>
    <tr>
      <td>GetTextBoxControl()</td>
      <td>テキストボックスを表示するコントロール</td>
    </tr>
    <tr>
      <td>GetLabelControl()</td>
      <td>文字を表示するコントロール</td>
    </tr>
    <tr>
      <td>SetLabelAlignCenter LABEL</td>
      <td>文字を中央</td>
    </tr>
    <tr>
      <td>SetLabelAlignLeft LABEL</td>
      <td>文字を左寄せ(デフォルト)</td>
    </tr>
    <tr>
      <td>SetLabelAlignRight LABEL</td>
      <td>文字を右寄せ</td>
    </tr>
  </tbody>
</table>

<h3 id="sample">Sample</h3>
<pre><code class="language-BAS"> VAR TESTOTWCTL,TESTOTWWND
 DEF I_TEST
  IF!CHKCALL("IsWinRunning")||!IsWinRunning()THEN'OTWが存在するか、存在した場合動いているか
   ExitProcess 1
   RETURN
  ENDIF
  VAR E
  ExtendControl "TEST",GetWindowControl() OUT TESTOTWCTL,E'Windowコントロールを継承する
  IF E THEN ExitProcess 1RETURN
  E=SetControlPainter(TESTOTWCTL,"TESTOTWPainter")
  NewTopLevelWindow TESTOTWCTL,"TEST",64,64 OUT TESTOTWWND,E
  IF E THEN ExitProcess 1
 END
 DEF TESTOTWPainter WND,CTL,T,A1,A2
  VAR E=CallBaseControlHandler(WND,CTL,T,A1,A2)'親のハンドラを呼び出す(これを呼ばないと枠が描画されない)
  IF E THEN RETURN
  E=GBeginWindow(WND)
  IF E THEN RETURN
  GFILLWindow WND,0,0,64,64,RGB(0,0,0)
  GPRINTWindow WND,0,0,"HELLO",RGB(255,255,255)
  E=GEndWindow(WND)
 END
 DEF L_TEST
  IF UpdateWindow(TESTOTWWND)THEN ExitProcess 1'ウィンドウが閉じられたりした
 END
</code></pre>
<p>## flag memo
- CTL_FRMBTNHANDLER
- CTL_LBTNFLG
- CTL_RBTNFLG
- CTL_BTNDWNFLG
- CTL_BTNUPFLG</p>

<p>文字列は”123”[0]みたいな使い方が可能</p>

<h2 id="section-1">これから実装したいもの</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GetScreenWidth()</td>
    </tr>
    <tr>
      <td>GetScreenHeight()</td>
    </tr>
    <tr>
      <td>GetWinVer$()</td>
    </tr>
  </tbody>
</table>

<h3 id="message">message</h3>

<table>
  <thead>
    <tr>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MouseLeave</td>
    </tr>
    <tr>
      <td>MouseDoubleClick</td>
    </tr>
  </tbody>
</table>

<h2 id="section-2">標準コントロール</h2>
<p>これらのコントロールを継承する際は親コントロールのHandlerを呼び出す必要がある</p>

<h3 id="window-1">Window</h3>

<table>
  <thead>
    <tr>
      <th>event</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Paint</td>
      <td>枠を描画</td>
    </tr>
    <tr>
      <td>ChFocus</td>
      <td>前面に移動</td>
    </tr>
  </tbody>
</table>

<h3 id="button">Button</h3>

<table>
  <thead>
    <tr>
      <th>event</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Paint</td>
      <td>ボタンを描画</td>
    </tr>
    <tr>
      <td>LMouseUp</td>
      <td>親ウィンドウにNotifを送信</td>
    </tr>
  </tbody>
</table>

<h4 id="section-3">操作</h4>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SetButtonAlignLeft WND</td>
      <td>ボタンの文字を左寄りにする</td>
    </tr>
    <tr>
      <td>SetButtonAlignRight WND</td>
      <td>ボタンの文字を右寄りにする</td>
    </tr>
    <tr>
      <td>SetButtonAlignCenter WND</td>
      <td>ボタンの文字を中央に配置する</td>
    </tr>
    <tr>
      <td>IsCheckedButton(WND)</td>
      <td>トグルボタンをチェックされているか</td>
    </tr>
    <tr>
      <td>UnCheckButton WND</td>
      <td>トグルボタンをチェックさせない</td>
    </tr>
    <tr>
      <td>CheckButton WND</td>
      <td>トグルボタンがチェックさせる</td>
    </tr>
  </tbody>
</table>

<h3 id="label">Label</h3>

<h3 id="scroll">Scroll</h3>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GetVScrollBarControl()</td>
      <td>縦スクロールバーコントロールを取得</td>
    </tr>
    <tr>
      <td>NewVScrollBar PARENT,SIZ OUT WND,E</td>
      <td>縦スクロールバーをPARENTに長さSIZで作成</td>
    </tr>
    <tr>
      <td>SetScrollBarSize WND,SIZ</td>
      <td>縦スクロールバーのサイズを設定</td>
    </tr>
    <tr>
      <td>GetScrollBarSize(WND)</td>
      <td>縦スクロールバーのサイズを取得</td>
    </tr>
    <tr>
      <td>SetScrollBarPosition WND,POS</td>
      <td>縦スクロールバーの位置を設定</td>
    </tr>
    <tr>
      <td>GetScrollBarPosition(WND)</td>
      <td>縦スクロールバーの位置を取得</td>
    </tr>
  </tbody>
</table>

<h3 id="listbox">ListBox</h3>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GetListBoxControl()</td>
      <td>リストボックスのコントロールを取得</td>
    </tr>
    <tr>
      <td>AddListBoxItem WND,ITEM$</td>
      <td>リストボックスにITEM$を追加</td>
    </tr>
    <tr>
      <td>AddArrayListBoxItem WND,ITEM$</td>
      <td>リストボックスに配列ITEM$を追加</td>
    </tr>
    <tr>
      <td>ListBoxChItem()</td>
      <td>選択アイテムが変化すると親ウィンドウにNotif(A1=WND,A2=ListBoxChItem)を送る</td>
    </tr>
    <tr>
      <td>GetListBoxSelectedText$(WND)</td>
      <td>リストボックスで選択されているアイテム名を取得</td>
    </tr>
    <tr>
      <td>SetChItemListBoxNotif WND,F</td>
      <td>選択アイテムが変化すると親ウィンドウにNotif(A1=WND,A2=ListBoxChItem)を送るかどうか</td>
    </tr>
    <tr>
      <td>ClearListBox WND</td>
      <td>リストボックスの項目を初期化</td>
    </tr>
  </tbody>
</table>

<h3 id="numupdown">NumUpDown</h3>

<table>
  <thead>
    <tr>
      <th> </th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GetNumUpDowCnontrol()</td>
      <td>NumUpDownのコントロールを取得</td>
    </tr>
    <tr>
      <td>GetNumUpDownValue(WND)</td>
      <td>NumUpDownの値を取得</td>
    </tr>
    <tr>
      <td>SetNumUpDownRange WND,MIN,MAX</td>
      <td>NumUpDownの範囲を設定</td>
    </tr>
  </tbody>
</table>

<h3 id="dropdownlist-dropdownlist">DropDownList (DROPDOWNLIST)</h3>

<h4 id="getdropdownlistcontrol">GetDropDownListControl()</h4>
<p>DropDownListのコントロールを取得</p>

<h4 id="getdropdownlistboxwnd">GetDropDownListBox(WND)</h4>
<p>DropDownListのListBox WNDを取得(これに対して項目を追加する)</p>

<h2 id="menu">Menu</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>NewMenu OUT MENU,E</td>
      <td>MENUを作成</td>
    </tr>
    <tr>
      <td>SetMenuBar WND,MENU</td>
      <td>未実装</td>
    </tr>
    <tr>
      <td>ShowMenu MENU,WND</td>
      <td>未実装,引数の順番が定まっていない</td>
    </tr>
    <tr>
      <td>GetWindowMenu(WND)</td>
      <td>WNDのMENUを取得</td>
    </tr>
    <tr>
      <td>AddMenuItem MENU,STR$,IVAR</td>
      <td>MENUにSTR$を追加,IVARはWindowNotifEventの時にARG2に指定される</td>
    </tr>
    <tr>
      <td>AddMenuItemSeparator MENU</td>
      <td>MENUにSeparatorを追加</td>
    </tr>
    <tr>
      <td>CheckMenu(MENU)</td>
      <td>MENUが存在すればTRUE</td>
    </tr>
    <tr>
      <td>NewTopLevelMenuWindow CTL,NAME$,WIDTH,HEIGHT OUT WND,ERR</td>
      <td> </td>
    </tr>
    <tr>
      <td>ShowContextMenu MENU,WND</td>
      <td>コンテキストメニューを表示</td>
    </tr>
    <tr>
      <td>AddSubMenuItem MENU,STR$,SUBMENU</td>
      <td>メニューにサブメニューを追加</td>
    </tr>
  </tbody>
</table>

<h2 id="window-group">Window Group</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>JoinWindowGroup(WND,WND2)</td>
      <td> </td>
    </tr>
    <tr>
      <td>LeaveWindowGroup WND</td>
      <td>未実装</td>
    </tr>
    <tr>
      <td>GetWindowGroupOwner(WND)</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h2 id="dialog">Dialog</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>NewDialogBox(CTL,NAME$,WIDTH,HEIGHT,OWNER,FLAG)</td>
      <td> </td>
    </tr>
    <tr>
      <td>NewModalDialogBox(CTL,NAME$,WIDTH,HEIGHT,OWNER)</td>
      <td>モーダルダイアログボックスを作成</td>
    </tr>
    <tr>
      <td>NewModelessDialogBox(CTL,NAME$,WIDTH,HEIGHT,OWNER)</td>
      <td>モーダレスダイアログボックスを作成</td>
    </tr>
  </tbody>
</table>

<h2 id="file-dialog">File dialog</h2>

<h3 id="openfiledialogownertypeid">OpenFileDialog(OWNER,TYPE$,ID)</h3>
<p>ファイルを開くダイアログを表示<br />
TYPE$にファイル種別(TXT/DAT)<br />
選択された場合IDをA1、ファイル名をA2$に入れてStrNotifが呼ばれる</p>

<h3 id="savefiledialogownertypeid">SaveFileDialog(OWNER,TYPE$,ID)</h3>
<p>ファイル保存ダイアログを表示<br />
TYPE$にファイル種別(TXT/DAT)<br />
選択された場合IDをA1、ファイル名をA2$に入れてStrNotifが呼ばれる</p>

<h2 id="windowop">WindowOP</h2>
<p>ウィンドウに対しての操作を効率化する
子ウィンドウを一々削除していたら再描画リクエストが一々確認されたりして非常に遅い
それをEndWindowOPでまとめてやる</p>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>BeginWindowOP(WND)</td>
      <td> </td>
    </tr>
    <tr>
      <td>EndWindowOP(WND)</td>
      <td> </td>
    </tr>
    <tr>
      <td>MoveWindow2(WND,X,Y)</td>
      <td>-&gt;MoveWindowOP(WND,X,Y)</td>
    </tr>
  </tbody>
</table>

<h2 id="section-4">拡張コントロール群</h2>
<p>標準コントロールの機能拡張版</p>

<h3 id="textboxex">TextBoxEx</h3>
<p>複数行編集、シンタックスハイライトに対応した拡張版</p>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GetTextBoxExControl()</td>
      <td>TextBoxExControlを取得</td>
    </tr>
    <tr>
      <td>TextBoxExSetText WND,TXT$</td>
      <td>WNDにTXT$を設定</td>
    </tr>
    <tr>
      <td>TextBoxGetText  WND OUT TXT$</td>
      <td>WNDのTextを取得</td>
    </tr>
    <tr>
      <td>SetTextBoxExPRGMode WND,FLG</td>
      <td>FLGがTRUEならばシンタックスハイライトを有効化</td>
    </tr>
    <tr>
      <td>TextBoxExSetSelectedText WND,TXT$</td>
      <td>現在選択されているTextにTXT$を設定</td>
    </tr>
    <tr>
      <td>TextBoxExGetSelectedText WND OUT TXT$</td>
      <td>現在選択されているTextを取得</td>
    </tr>
    <tr>
      <td>TextBoxExCopy WND</td>
      <td>クリップボードにコピー</td>
    </tr>
    <tr>
      <td>TextBoxExCut WND</td>
      <td>クリップボードに切り取り</td>
    </tr>
    <tr>
      <td>TextBoxExPaste WND</td>
      <td>クリップボードから貼り付け</td>
    </tr>
  </tbody>
</table>

<h3 id="richtexteditor">RICHTEXTEDITOR</h3>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>RichTextBold()</td>
      <td>フラグ</td>
    </tr>
    <tr>
      <td>RichTextItalic()</td>
      <td>フラグ</td>
    </tr>
    <tr>
      <td>RichTextStrike()</td>
      <td>フラグ</td>
    </tr>
    <tr>
      <td>RichTextUnderline()</td>
      <td>フラグ</td>
    </tr>
    <tr>
      <td>RICHTEXT X,Y,C,STYLE,SIZE,COL</td>
      <td>RICHTEXTを表示</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>RTESetBold WND,F</td>
      <td> </td>
    </tr>
    <tr>
      <td>RTESetItalic WND,F</td>
      <td> </td>
    </tr>
    <tr>
      <td>RTESetStrike WND,F</td>
      <td> </td>
    </tr>
    <tr>
      <td>RTESetUnderline WND,F</td>
      <td> </td>
    </tr>
    <tr>
      <td>RTESetTextColor WND,COL</td>
      <td> </td>
    </tr>
    <tr>
      <td>RTESetAlignLeft WND</td>
      <td> </td>
    </tr>
    <tr>
      <td>RTESetAlignCenter WND</td>
      <td> </td>
    </tr>
    <tr>
      <td>RTESetAlignRight WND</td>
      <td> </td>
    </tr>
    <tr>
      <td>RTESetFontSize WND</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 id="rtenew-rte">RTENew RTE</h4>
<p>初期化</p>

<h4 id="rteopen-rtefile-out-err">RTEOpen RTE,FILE$ OUT ERR</h4>
<p>FILE$を開く</p>

<h4 id="rtesave-rtefile-out-err">RTESave RTE,FILE$ OUT ERR</h4>
<p>FILE$に保存する</p>

<h4 id="rteclear-wnd">RTEClear WND</h4>
<p>インデントや見出しなどを消す</p>

<h4 id="rteindent-wndindent">RTEIndent WND,INDENT</h4>
<p>インデントをINDENT px増やす</p>

<h4 id="rtesetorderedlist-wnd">RTESetOrderedList WND</h4>
<ul>
  <li>こういうリスト</li>
</ul>

<h4 id="rtesetunorderedlist-wnd">RTESetUnorderedList WND</h4>
<ol>
  <li>こういうリスト</li>
</ol>

<h4 id="rtesetheading-wndlevel">RTESetHeading WND,LEVEL</h4>
<p>LEVEL(1&lt;=LEVEL&lt;=6)見出しを付ける</p>

<h4 id="rtecopy-wnd">RTECopy WND</h4>
<p>コピー</p>

<h4 id="rtepaste-wnd">RTEPaste WND</h4>
<p>ペースト</p>

<h4 id="rtecut-wnd">RTECut WND</h4>
<p>切り取り</p>

<h4 id="rteselectall-wnd">RTESelectAll WND</h4>
<p>すべて選択</p>

<h4 id="rteaddtable-wndrowcol">RTEAddTable WND,ROW,COL</h4>
<p>ROW行COL列の表を作成</p>

<h2 id="section-5">ダイアログ</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SaveFileDialog(OWNER,TYPE$,ID)</td>
      <td>今の所TYPEはTXTまたはDATのみ</td>
    </tr>
    <tr>
      <td>OpenFileDialog(OWNER,TYPE$,ID)</td>
      <td>今の所TYPEはTXTまたはDATのみ</td>
    </tr>
    <tr>
      <td>MessageBox(WND,TITLE$,TEXT$,FLAG)</td>
      <td>メッセージボックスを作成</td>
    </tr>
    <tr>
      <td>MessageBoxOK()</td>
      <td>OKボタンのフラグ</td>
    </tr>
    <tr>
      <td>MessageBoxNotifOK()</td>
      <td>OKボタンが押されたときにWNDへ送信される</td>
    </tr>
    <tr>
      <td>MessageBoxNotifCancel()</td>
      <td>キャンセルされたときにWNDへ送信される</td>
    </tr>
    <tr>
      <td>MessageBoxNotifID()</td>
      <td>MessageBoxが閉じられたときにWNDへ送信されるNotifID</td>
    </tr>
  </tbody>
</table>

<h2 id="clipboard">Clipboard</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ClearClipboard</td>
      <td>クリップボードを初期化</td>
    </tr>
    <tr>
      <td>ClipboardContainsText()</td>
      <td>クリップボードに文字列が格納されているか</td>
    </tr>
    <tr>
      <td>ClipboardGetText$()</td>
      <td>クリップボードに格納された文字列を取得(無ければ空文字)</td>
    </tr>
    <tr>
      <td>ClipboardSetText V$</td>
      <td>クリップボードに文字列を格納</td>
    </tr>
    <tr>
      <td>ClipboardContaisFile()</td>
      <td>クリップボードにファイルが格納されているか</td>
    </tr>
    <tr>
      <td>ClipboardGetFile OUT ISCUT,PATH$)</td>
      <td>クリップボードに格納されたファイルを取得(無ければ空文字)ISCUTがTRUEならば切り取り</td>
    </tr>
    <tr>
      <td>ClipboardSetFile ISCUT,PATH$</td>
      <td>クリップボードにファイルを格納、ISCUTがTRUEならば切り取り</td>
    </tr>
    <tr>
      <td>ClipboardSetData$ TYPE$,V$</td>
      <td>クリップボードにTYPE$の文字列データを設定</td>
    </tr>
    <tr>
      <td>ClipboardGetData$ TYPE$ OUT DATA$,CONTAINS</td>
      <td>クリップボードからTYPE$の文字列データを取得、CONTAINSがFALSEなら含まれていない</td>
    </tr>
  </tbody>
</table>

<h3 id="clipboarddata">ClipboardData</h3>
<p>### “RichText”
リッチテキスト文字列が入っている</p>

<h2 id="image">Image</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>NewImage ARRAY,WIDTH,HEIGHT OUT IMG,E</td>
      <td>画像を作成</td>
    </tr>
    <tr>
      <td>LoadImage FILE$,W,H OUT IMG,E</td>
      <td>画像を二次元配列DATファイルから読み込み</td>
    </tr>
    <tr>
      <td>GLOADImage X,Y,IMG,F</td>
      <td>現在のグラフィック面にX,YにIMGを描画</td>
    </tr>
    <tr>
      <td>CheckImage(IMG)</td>
      <td>画像が正常か確認</td>
    </tr>
    <tr>
      <td>DeleteImage(IMG)</td>
      <td>画像を削除</td>
    </tr>
  </tbody>
</table>

<h2 id="section-6">関連付け</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GetAssociatedProgram$(TYP$,EXT$)</td>
      <td>TYP$とEXT$に関連付けられたものを取得</td>
    </tr>
    <tr>
      <td>AssociateFile(TYP$,EXT$,NAME$)</td>
      <td>拡張子をNAME$に関連付けるTYP$に” “/”*”/”/”,EXT$に拡張子(e.g.TXT)成功するとFALSE</td>
    </tr>
    <tr>
      <td>ExecFile(PATH$)</td>
      <td>PATH$に関連付けられたプログラムをPATH$を引数に設定して起動</td>
    </tr>
  </tbody>
</table>

<h2 id="section-7">直接描画</h2>

<table>
  <thead>
    <tr>
      <th>関数</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>GBeginDirect(WND)</td>
      <td>直接描画を可能にする(GPSETなどが使える)</td>
    </tr>
    <tr>
      <td>GCopyDirect(WND,X,Y,W,H,X3,Y3,MODE)</td>
      <td>直接描画を終了し、GBeginWindow(WND)をして転送</td>
    </tr>
  </tbody>
</table>

<h2 id="section-8">フォント</h2>
<p>フォント周りのAPI</p>

<h3 id="calctextsize">CalcTextSize</h3>
<p><code class="highlighter-rouge">CalcTextSize TEXT$ OUT W,H</code>
デフォルトフォントでのテキストのサイズを計算</p>

<h2 id="im">IM</h2>
<p><a href="https://github.com/otya128/OTYAX5/wiki/OTW-IM">こちらを参照</a></p>

</body>
</html>
